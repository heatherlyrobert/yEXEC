#!/usr/local/bin/koios
#   koios-polos (axis of heaven) unit testing meta-language



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
PREP          include the prototype headers                                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   - - - - -   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
   incl       include public header                yEXEC.h                     - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   - - - - -   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
   incl       include private header               yEXEC_priv.h                - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   - - - - -   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP          (FIFO) verify fifo creation and removal                            0s   existance       yexec_fifo__verify, yEXEC_fifo_create, yEXEC_fifo_destroy                    ((01.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       prepare for run                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     initialize the system                yexec__unit_quiet                                                                                                                 i_equal     0                                                                                                    
     local    create working variable              - - - - - - - - - - - - -   char  x_name    [LEN_PATH]  = "/tmp/test.fifo";                                                                                                                                                                            

   COND       attempt to verify a missing fifo                                   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call verify                          yexec_fifo__verify          '-'  , x_name                                                                                         i_lesser    0                                                                                                    
     exec     ... check for fifo                   yURG_peek_exists            x_name                                                                                                i_lesser    0                                                                                                    

   COND       verify creating fifo                                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call verify                          yexec_fifo__verify          'y'  , x_name                                                                                         i_equal     0                                                                                                    
     exec     ... check for fifo                   yURG_peek_exists            x_name                                                                                                i_equal     0                                                                                                    

   COND       attempt a duplicate creation                                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call verify                          yexec_fifo__verify          'y'  , x_name                                                                                         i_equal     1                                                                                                    
     exec     ... check for fifo                   yURG_peek_exists            x_name                                                                                                i_equal     0                                                                                                    

   COND       attempt to destroy using a null name                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call destroy                         yEXEC_fifo_destroy          NULL                                                                                                  i_lesser    0                                                                                                    

   COND       verify destroying fifo                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call destroy                         yEXEC_fifo_destroy          x_name                                                                                                i_equal     0                                                                                                    
     exec     ... check for fifo                   yURG_peek_exists            x_name                                                                                                i_lesser    0                                                                                                    

   COND       attempt a duplicate destruction                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call destroy                         yEXEC_fifo_destroy          x_name                                                                                                i_lesser    0                                                                                                    
     exec     ... check for fifo                   yURG_peek_exists            x_name                                                                                                i_lesser    0                                                                                                    

   COND       attempt to create using a null name                                - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call verify                          yexec_fifo__verify          'y'  , NULL                                                                                           i_lesser    0                                                                                                    

   COND       wrap up testing                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.005))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     wrap up                              yexec__unit_end                                                                                                                   i_equal     0                                                                                                    



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP          (FIFO) verify openning and closing                                 0s   access          yexec_fifo__open, yexec_fifo__close                                          ((01.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       prepare for run                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     initialize the system                yexec__unit_quiet                                                                                                                 i_equal     0                                                                                                    
     local    create working variable              - - - - - - - - - - - - -   char  x_name    [LEN_PATH]  = "/tmp/test.fifo";                                                                                                                                                                            

   COND       attempt to open a non-existing fifo                                - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call open                            yexec_fifo__open            x_name                                                                                                i_lesser    0                                                                                                    

   COND       attempt to close a non-open fifo                                   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call close                           yexec_fifo__close                                                                                                                 i_lesser    0                                                                                                    

   COND       verify creating fifo                                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call verify                          yexec_fifo__verify          'y'  , x_name                                                                                         i_equal     0                                                                                                    
     exec     ... check for fifo                   yURG_peek_exists            x_name                                                                                                i_equal     0                                                                                                    

   COND       verify openning the fifo                                           - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call open                            yexec_fifo__open            x_name                                                                                                i_equal     0                                                                                                    

   COND       attempt to re-open the fifo                                        - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call open                            yexec_fifo__open            x_name                                                                                                i_lesser    0                                                                                                    

   COND       verify closing the fifo                                            - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call close                           yexec_fifo__close                                                                                                                 i_equal     0                                                                                                    

   COND       attempt to re-close the fifo                                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call close                           yexec_fifo__close                                                                                                                 i_lesser    0                                                                                                    

   COND       verify destroying fifo                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call destroy                         yEXEC_fifo_destroy          x_name                                                                                                i_equal     0                                                                                                    
     exec     ... check for fifo                   yURG_peek_exists            x_name                                                                                                i_lesser    0                                                                                                    

   COND       wrap up testing                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.005))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     wrap up                              yexec__unit_end                                                                                                                   i_equal     0                                                                                                    





#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP          (FIFO) verify openning and closing                                 0s   access          yexec_fifo__open, yexec_fifo__close                                          ((01.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       prepare for run                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     initialize the system                yexec__unit_quiet                                                                                                                 i_equal     0                                                                                                    
     local    create working variable              - - - - - - - - - - - - -   char  x_name    [LEN_PATH]  = "/tmp/test.fifo";                                                                                                                                                                            
     local    create working variable              - - - - - - - - - - - - -   char  x_recd    [LEN_RECD]  = "";                                                                                                                                                                                          
     local    create working variable              - - - - - - - - - - - - -   char  x_out     [LEN_PATH]  = "/tmp/test.fifo.output";                                                                                                                                                                     
     exec     ... remove temp output               yURG_rm                     x_out                                                                                                 i_equal     0                                                                                                    

   COND       verify creating fifo                                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call verify                          yexec_fifo__verify          'y'  , x_name                                                                                         i_equal     0                                                                                                    
     exec     ... check for fifo                   yURG_peek_exists            x_name                                                                                                i_equal     0                                                                                                    

   COND       verify listening to an empty fifo                                  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call listen                          yEXEC_fifo_listen           '-'    , x_name  , yexec_fifo__listener                                                               i_equal     0                                                                                                    
     exec     ... check for output file            yURG_peek_exists            x_out                                                                                                 i_equal     -1                                                                                                   

   COND       verify speaking to the fifo                                        - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call speak                           yEXEC_fifo_speak            x_name , "testing"                                                                                    i_equal     1                                                                                                    
     exec     ... check for output file            yURG_peek_exists            x_out                                                                                                 i_equal     -1                                                                                                   

   COND       verify listening to that single entry                              - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call listen                          yEXEC_fifo_listen           '-'    , x_name  , yexec_fifo__listener                                                               i_equal     1                                                                                                    
     exec     ... check for output file            yURG_peek_exists            x_out                                                                                                 i_equal     0                                                                                                    
     exec     ... check for output file            yURG_peek_count             x_out                                                                                                 i_equal     1                                                                                                    
     exec     ... check for output file            yURG_peek                   x_out  , 0                                                                                            s_equal     testing                                                                                              
     exec     ... check for output file            yURG_peek                   x_out  , 1                                                                                            s_equal                                                                                                          

   COND       verify speaking several entries                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call speak                           yEXEC_fifo_speak            x_name , "second longer record"                                                                       i_equal     1                                                                                                    
     exec     call speak                           yEXEC_fifo_speak            x_name , "and a third one with even more text"                                                        i_equal     1                                                                                                    

   COND       verify listening to the new entries                                - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call listen                          yEXEC_fifo_listen           '-'    , x_name  , yexec_fifo__listener                                                               i_equal     2                                                                                                    
     exec     ... check for output file            yURG_peek_exists            x_out                                                                                                 i_equal     0                                                                                                    
     exec     ... check for output file            yURG_peek_count             x_out                                                                                                 i_equal     3                                                                                                    
     exec     ... check for output file            yURG_peek                   x_out  , 0                                                                                            s_equal     testing                                                                                              
     exec     ... check for output file            yURG_peek                   x_out  , 1                                                                                            s_equal     second longer record                                                                                 
     exec     ... check for output file            yURG_peek                   x_out  , 2                                                                                            s_equal     and a third one with even more text                                                                  





   COND       verify destroying fifo                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call destroy                         yEXEC_fifo_destroy          x_name                                                                                                i_equal     0                                                                                                    
     exec     ... check for fifo                   yURG_peek_exists            x_name                                                                                                i_lesser    0                                                                                                    
     exec     ... remove temp output               yURG_rm                     x_out                                                                                                 i_equal     0                                                                                                    

   COND       wrap up testing                                                    - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.005))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     wrap up                              yexec__unit_end                                                                                                                   i_equal     0                                                                                                    



